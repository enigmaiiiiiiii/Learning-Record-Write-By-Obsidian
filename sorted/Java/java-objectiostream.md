# Java - Object Stream 

## prerequirement

- only object support Serializable interface can be transfered by stream

## ObjectOutputStream

- used to serialize object to output stream
- `ObjectOutputStream(OutputStream out)`: create object from specified OutputStream
- `writeObject()`: write object to stream

## ObjectInputStream

- used to deserialize object from input stream
- `ObjectInputStream(InputStream in)`: create object from specified InputStream
- `readObject()`: read object from stream

## Object Need Special Serialization/Deserialization


```java
private void writeObject(java.io.ObjectOutputStream stream) 
    throws IOException;
private void readObject(java.io.ObjectInputStream stream)
    throws IOException, ClassNotFoundException;
private void readObjectNoData()
    throws ObjectStreamException;
```

## Version ID

- field `serialVersionUID` is used to identify the version of object
- if not define, default version id will be generated by compiler

```java
public static final long serialVersionUID = 42L;  // serializable version id
```

- if version id is same, and class field is different, compatible mode will be used to deserialize
  - same field will be reserved
  - different field will be initialized to 0
  - field not exist in new class will be discarded
- if version id is different, and class field is different, can not deserialize, exception will be thrown

## transient keyword

field that marked by transient will be ignored when serialize

```java
public class Foo implements Serializable {
    private static final long serialVersionUID = 42L;
    private transient int a;
    private int b;
}
```

- field `a` will be ignored when serialize



