# 文件描述符

- 是一个非负整数
- 对文件描述符的理解
  1. 伴随着进程产生
  2. 由进程创建
  3. 打开文件时创建, 文件运行时才有文件描述符
- 一个文件描述符对应一个**打开**的文件
- [[进程]]是通过文件描述符来访问文件的
- 是UNIX类操作系统特有的概念

- 如用vim打开一个文件`vim test`, `ls -l /proc/test文件id/fd`输出如下内容

```bash
lrwx------ 1 user user 0 Sep  9 10:48 0 -> /dev/tty1
lrwx------ 1 user user 0 Sep  9 10:48 1 -> /dev/tty1
lrwx------ 1 user user 0 Sep  9 10:48 2 -> /dev/tty1
lrwx------ 1 user user 0 Sep  9 10:48 4 -> /home/user/code/.test.swn
```

  除系统自动创建的文件描述符外，还有一个编号为4的文件，vim程序会将所有修改都写入该文件

- 创建文件描述符命令
  - `exec num<file` 创建仅可用于输入的文件描述符
  - `exec num>file` 创建仅可用于输出的文件描述符
  - `&文件描述符`调用文件描述符
  - `exec 文件描述符<&-` 关闭文件描述符
  - `exec 文件描述符>&-` 关闭文件描述符
  
## 进程表

- 每一个进程有一个登记项
- 由文件描述符组成的数组， 通常记为`fd`
- 元素指向一个结构体file
- 每当进程打开一个文件时，为文件指定数组中的一个元素
- 每个进程创建三个标准文件描述符
  - `#define STDIN_FILENO 0`, `fd[STDIN_FILENO]`(标准输入)
  - `#define STDOUT_FILENO 1`,   `fd[STDOUT_FILENO]`(标准输出)
  -  `#define STDERR_FILENO 2`,`fd[STDERR_FILENO]`(标准错误)
- 默认size上限1024  
  
## vnode

- 与文件相关的结构
- 包含inode

## inode


