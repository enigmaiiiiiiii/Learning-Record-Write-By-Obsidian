# Makefile - Execution Process

## First Target Will Be Run By default

a makefile like

```makefile
t2: t1
 echo 2
t1:
 echo 1
```

run command `make` output

```
echo 1
echo 2
```

for this makefile

```makefile
t1:
 echo 1
t2: t1
 echo 2
```

run command `make` output

```
echo 1
```

run command `make t2` output

```
echo 1
echo 2
```

## When Target Will Be Rerun

Assume makefile like that

```makefile
hello: hello.o
	echo 3
	gcc hello.o -o hello

hello.o: hello.c 
	echo 2
	gcc -c hello.c -o hello.o

hello.c:
	echo 1
	echo "#include <stdio.h>\n\nint main() { printf(\"hello makefile\"); }" > hello.c
```

first time run command `make`, the output is

```
echo 1
1
echo "#include <stdio.h>\n\nint main() { printf(\"hello makefile\"); }" > hello.c
echo 2
2
gcc -c hello.c -o hello.o
echo 3
3
gcc hello.o -o hello
```

run command `make` again, the output is

```
make: `hello' is up to date.
```

change "hello makefile" to "hello another" in `makefile`

```
	echo "#include <stdio.h>\n\nint main() { printf(\"hello another\"); }" > hello.c
```

- run command `make` again, output:

```
make: `hello' is up to date.
```

- file `hello.c` doesn't being modified

- change content file `hello.c` generated by makefile like this

```c
#include <stdio.h>

int main() { printf("hello another makefile"); }
```

- run command `make` again, output:

```
echo 2
2
gcc -c hello.c -o hello.o
echo 3
3
gcc hello.o -o hello
```


## Conclusion

assume this makefile unit

```
target: dependencies
    command
```

- command `make` by default run first unit
- to run other unit, use `make target`
- units execute order based on dependencies
- units will only run if
  - target file doesn't exist
  - or it's dependencies is updated

## Tricks

run multiple target

```
all: one two three

one:
	touch one
two:
	touch two
three:
	touch three

clean:
	rm -f one two three
```
